import{c as E,i as $,e as f,d,h as c,f as Q,l as I,a as N,g as R,aK as w,ag as B,a4 as H,B as _,C as S,D as T,a6 as x,a8 as M,a9 as z,aL as L,E as C,F as y,ah as F,aM as P,G as q,a2 as j,aj as U,r as b,a5 as A,w as k}from"./index.8f0ae387.js";import{Q as G,c as V,b as D,a as K,h as O}from"./calculateTime.e105a32e.js";var J=E({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:a}){const{proxy:{$q:n}}=R(),t=$(I,f);if(t===f)return console.error("QPage needs to be a deep child of QLayout"),f;if($(N,f)===f)return console.error("QPage needs to be child of QPageContainer"),f;const m=d(()=>{const l=(t.header.space===!0?t.header.size:0)+(t.footer.space===!0?t.footer.size:0);if(typeof e.styleFn=="function"){const g=t.isContainer.value===!0?t.containerHeight.value:n.screen.height;return e.styleFn(l,g)}return{minHeight:t.isContainer.value===!0?t.containerHeight.value-l+"px":n.screen.height===0?l!==0?`calc(100vh - ${l}px)`:"100vh":n.screen.height-l+"px"}}),r=d(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>c("main",{class:r.value,style:m.value},Q(a.default))}}),W=E({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(e,{slots:a}){const n=d(()=>e.sent===!0?"sent":"received"),t=d(()=>`q-message-text-content q-message-text-content--${n.value}`+(e.textColor!==void 0?` text-${e.textColor}`:"")),s=d(()=>`q-message-text q-message-text--${n.value}`+(e.bgColor!==void 0?` text-${e.bgColor}`:"")),m=d(()=>"q-message-container row items-end no-wrap"+(e.sent===!0?" reverse":"")),r=d(()=>e.size!==void 0?`col-${e.size}`:""),l=d(()=>({msg:e.textHtml===!0?"innerHTML":"textContent",stamp:e.stampHtml===!0?"innerHTML":"textContent",name:e.nameHtml===!0?"innerHTML":"textContent",label:e.labelHtml===!0?"innerHTML":"textContent"}));function g(i){return a.stamp!==void 0?[i,c("div",{class:"q-message-stamp"},a.stamp())]:e.stamp?[i,c("div",{class:"q-message-stamp",[l.value.stamp]:e.stamp})]:[i]}function h(i,o){const v=o===!0?i.length>1?u=>u:u=>c("div",[u]):u=>c("div",{[l.value.msg]:u});return i.map((u,p)=>c("div",{key:p,class:s.value},[c("div",{class:t.value},g(v(u)))]))}return()=>{const i=[];a.avatar!==void 0?i.push(a.avatar()):e.avatar!==void 0&&i.push(c("img",{class:`q-message-avatar q-message-avatar--${n.value}`,src:e.avatar,"aria-hidden":"true"}));const o=[];a.name!==void 0?o.push(c("div",{class:`q-message-name q-message-name--${n.value}`},a.name())):e.name!==void 0&&o.push(c("div",{class:`q-message-name q-message-name--${n.value}`,[l.value.name]:e.name})),a.default!==void 0?o.push(h(w(a.default()),!0)):e.text!==void 0&&o.push(h(e.text)),i.push(c("div",{class:r.value},o));const v=[];return a.label!==void 0?v.push(c("div",{class:"q-message-label"},a.label())):e.label!==void 0&&v.push(c("div",{class:"q-message-label",[l.value.label]:e.label})),v.push(c("div",{class:m.value},i)),c("div",{class:`q-message q-message-${n.value}`},v)}}});const X={__name:"MessagesList",props:{messages:Array},setup(e){const a=H(),n=d(()=>a.getters["chat/GET_CURRENT_USER"]),t=s=>{var m;return((m=n.value)==null?void 0:m.id)===s};return(s,m)=>(_(),S(D,{class:"list-size"},{default:T(()=>[(_(!0),x(M,null,z(e.messages,r=>(_(),S(G,{key:r.id,class:L({"justify-end":t(r.senderId)})},{default:T(()=>[C(W,{text:[r.content],name:r.senderDisplayName,avatar:r.senderAvatarUrl,sent:t(r.senderId),stamp:y(V)(r.created_at)},null,8,["text","name","avatar","sent","stamp"])]),_:2},1032,["class"]))),128))]),_:1}))}};var Y=B(X,[["__scopeId","data-v-86b81e3c"]]);const Z={class:"flex items-center justify-between bg-grey-4",style:{"min-height":"4rem"}},ee={class:"flex items-center"},te={class:"q-ml-md text-h5"},ae={__name:"ChatHeader",props:{title:String,avatarUrl:String,selectedChat:Object},setup(e){const{title:a,avatarUrl:n,selectedChat:t}=e,s=H(),m=$("toggleShowVideoTrack"),r=d(()=>s.getters["chat/GET_CURRENT_USER"]);F(P);const l=async()=>{m(),!t.call_id&&(r.value.id===t.sender_id?(t.sender_id,t.consumer_id):(t.consumer_id,t.sender_id))};return(g,h)=>(_(),x("header",Z,[q("div",ee,[q("div",null,[C(K,{class:"q-ml-md avatar-min-size",src:e.avatarUrl},null,8,["src"])]),q("span",te,j(e.title),1),C(U,{class:"q-mx-md text-h5 text-primary cur-pointer",name:"videocam",onClick:l})]),C(U,{class:"q-mx-md text-h5 text-primary cur-pointer",name:"arrow_back"})]))}};const se={class:"flex column relative w-100p"},ne={key:0,class:"flex justify-center items-center"},re=q("span",{class:"text-h3 text-center"},"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0447\u0430\u0442...",-1),le=[re],ce={key:1},ie={key:0,class:"text-center text-h3"},oe={__name:"ChatSpace",setup(e){var i;const a=H(),n=b(""),t=b(""),s=d(()=>a.getters["chat/GET_CURRENT_CHAT"]),m=b(""),r=d(()=>a.getters["chat/GET_CURRENT_USER"]),l=b({chat_id:(i=s==null?void 0:s.value)==null?void 0:i.id}),{result:g,loading:h}=A(O,l);return k(s,async o=>{l.value.chat_id=o==null?void 0:o.id,r.value.id===s.value.sender_id?(n.value=s.value.consumer_avatar,t.value=s.value.consumer_firstName):(n.value=s.value.sender_avatar,t.value=s.value.sender_firstName)}),k(h,o=>{var v,u;o||(m.value=(u=(v=g==null?void 0:g.value)==null?void 0:v.chats[0])==null?void 0:u.call_id)}),(o,v)=>{var u,p;return _(),x("div",se,[y(s)?(_(),x("div",ce,[C(ae,{title:t.value,avatarUrl:n.value,selectedChat:y(s)},null,8,["title","avatarUrl","selectedChat"]),y(h)?(_(),x("div",ie," \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0439... ")):(_(),S(Y,{key:1,messages:(p=(u=y(g))==null?void 0:u.chats[0])==null?void 0:p.messages},null,8,["messages"]))])):(_(),x("div",ne,le))])}}},me={__name:"IndexPage",setup(e){return(a,n)=>(_(),S(J,{class:"flex"},{default:T(()=>[C(oe)]),_:1}))}};export{me as default};
